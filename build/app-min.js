$(document).ready(function(){console.log("doc ready");var e=[],t=JSON.parse(localStorage.getItem("fermentables")),o=JSON.parse(localStorage.getItem("fermentablesFiltered")),a=[],c=JSON.parse(localStorage.getItem("hops")),n=JSON.parse(localStorage.getItem("hopsFiltered")),r=[],s=JSON.parse(localStorage.getItem("yeasts")),l=JSON.parse(localStorage.getItem("yeastsFiltered")),d=[],p=JSON.parse(localStorage.getItem("adjuncts")),g=JSON.parse(localStorage.getItem("adjunctsFiltered")),b=[],i=JSON.parse(localStorage.getItem("styles")),f=JSON.parse(localStorage.getItem("stylesFiltered")),u=function(e,t,o,a,c,n,r){var s=e,l=t,d=r;console.log("loop ",s),$.get("https://cors-anywhere.herokuapp.com/http://api.brewerydb.com/v2/"+d+"/?key=166f0b6348fdccde864dc9aecb3d50bb&p="+s.toString()).done(function(e){c=c.concat(e.data),s+=1,l>=s?u(s,l,o,a,c,n,r):(o=c,localStorage.setItem(d,JSON.stringify(o)),m(o,a,n,r))}).fail(function(e){console.log("Fail Log: ",e)})},m=function(e,t,o,a){console.log("filterData called");for(var c=[],n=0;n<e.length;n++)e[n].hasOwnProperty(o)&&(c="styles"===a?c.concat(e[n].name):c.concat(e[n]));t=c,localStorage.setItem(a+"Filtered",JSON.stringify(t)),y(t,a)},y=function(e,t){for(var o=$(document).find("#"+t+"-selector").children("optgroup"),a=0;a<e.length;a++)if("yeasts"!==t){var c=e[a].name;$(o).append("<option>"+c+"</option>")}else{var n=e[a].supplier,r=e[a].productId,c=e[a].name,s=e[a].yeastFormat,l=e[a].yeastType;$(o).append("<option>"+c+" - "+n+" "+r+" - "+s+" "+l+" yeast</option>")}};t?y(t,"fermentables"):$.get("https://cors-anywhere.herokuapp.com/http://api.brewerydb.com/v2/fermentables/?key=166f0b6348fdccde864dc9aecb3d50bb",function(){}).done(function(a){var c=a.currentPage,n=a.numberOfPages;e=e.concat(a.data),n>c&&u(c+1,n,t,o,e,"potential","fermentables")}),c?y(n,"hops"):$.get("https://cors-anywhere.herokuapp.com/http://api.brewerydb.com/v2/hops/?key=166f0b6348fdccde864dc9aecb3d50bb",function(){}).done(function(e){var t=e.currentPage,o=e.numberOfPages;a=a.concat(e.data),o>t&&u(t+1,o,c,n,a,"alphaAcidMin","hops")}),s?y(l,"yeasts"):$.get("https://cors-anywhere.herokuapp.com/http://api.brewerydb.com/v2/yeasts/?key=166f0b6348fdccde864dc9aecb3d50bb",function(){}).done(function(e){var t=e.currentPage,o=e.numberOfPages;console.log("number of yeast pages = ",o),r=r.concat(e.data),o>t&&u(t+1,o,s,l,r,"productId","yeasts")}),p?y(g,"adjuncts"):(console.log("loop 1"),$.get("https://cors-anywhere.herokuapp.com/http://api.brewerydb.com/v2/adjuncts/?key=166f0b6348fdccde864dc9aecb3d50bb",function(){}).done(function(e){var t=e.currentPage,o=e.numberOfPages;console.log("Number of Adjunct Pages: ",o),d=d.concat(e.data),o>t&&u(t+1,o,p,g,d,"name","adjuncts")})),i?y(f,"styles"):(console.log("loop 1"),$.get("https://cors-anywhere.herokuapp.com/http://api.brewerydb.com/v2/styles/?key=166f0b6348fdccde864dc9aecb3d50bb",function(){}).done(function(e){d=d.concat(e.data),u(1,1,i,f,b,"ibuMin","styles")})),$.get("https://cors-anywhere.herokuapp.com/http://api.brewerydb.com/v2/styles/?key=166f0b6348fdccde864dc9aecb3d50bb&p=3",function(){}).done(function(e){console.log(e)})});