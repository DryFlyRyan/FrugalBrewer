$(document).ready(function(){console.log("doc ready");var e=[],t=JSON.parse(localStorage.getItem("fermentables")),a=JSON.parse(localStorage.getItem("fermentablesFiltered")),o=[],n=JSON.parse(localStorage.getItem("hops")),s=JSON.parse(localStorage.getItem("hopsFiltered")),c=[],r=JSON.parse(localStorage.getItem("yeasts")),d=JSON.parse(localStorage.getItem("yeastsFiltered")),i=[],l=JSON.parse(localStorage.getItem("adjuncts")),p=JSON.parse(localStorage.getItem("adjunctsFiltered")),b=[],u=JSON.parse(localStorage.getItem("styles")),f=JSON.parse(localStorage.getItem("stylesFiltered")),y=function(e,t,a,o,n,s,c){var r=e,d=t,i=c;console.log("loop ",r),$.get("https://cors-anywhere.herokuapp.com/http://api.brewerydb.com/v2/"+i+"/?key=166f0b6348fdccde864dc9aecb3d50bb&p="+r.toString()).done(function(e){n=n.concat(e.data),r+=1,d>=r?y(r,d,a,o,n,s,c):(a=n,localStorage.setItem(i,JSON.stringify(a)),g(a,o,s,c))}).fail(function(e){console.log("Fail Log: ",e)})},g=function(e,t,a,o){console.log("filterData called");for(var n=[],s=0;s<e.length;s++)e[s].hasOwnProperty(a)&&(n="styles"===o?n.concat(e[s].name):n.concat(e[s]));t=n,localStorage.setItem(o+"Filtered",JSON.stringify(t)),m(t,o)},m=function(e,t){for(var a=$(document).find("#"+t+"-selector").children(".api-destination"),o=0;o<e.length;o++){var n=e[o].id,s=e[o].name;if("yeasts"!==t)$(a).append('<option data-id="'+n+'" data-name="'+s+'" data-source="'+t+'">'+s+"</option>");else{var c=e[o].supplier,r=e[o].productId,d=e[o].yeastFormat,i=e[o].yeastType,l=s+" - "+c+" "+r+" - "+d+" "+i+" yeast";$(a).append('<option data-id="'+n+' data-name="'+l+'" data-source="'+t+'">'+s+" - "+c+" "+r+" - "+d+" "+i+" yeast</option>")}}};t?m(t,"fermentables"):$.get("https://cors-anywhere.herokuapp.com/http://api.brewerydb.com/v2/fermentables/?key=166f0b6348fdccde864dc9aecb3d50bb",function(){}).done(function(o){var n=o.currentPage,s=o.numberOfPages;e=e.concat(o.data),s>n&&y(n+1,s,t,a,e,"potential","fermentables")}),n?m(s,"hops"):$.get("https://cors-anywhere.herokuapp.com/http://api.brewerydb.com/v2/hops/?key=166f0b6348fdccde864dc9aecb3d50bb",function(){}).done(function(e){var t=e.currentPage,a=e.numberOfPages;o=o.concat(e.data),a>t&&y(t+1,a,n,s,o,"alphaAcidMin","hops")}),r?m(d,"yeasts"):$.get("https://cors-anywhere.herokuapp.com/http://api.brewerydb.com/v2/yeasts/?key=166f0b6348fdccde864dc9aecb3d50bb",function(){}).done(function(e){var t=e.currentPage,a=e.numberOfPages;console.log("number of yeast pages = ",a),c=c.concat(e.data),a>t&&y(t+1,a,r,d,c,"productId","yeasts")}),l?m(p,"adjuncts"):(console.log("loop 1"),$.get("https://cors-anywhere.herokuapp.com/http://api.brewerydb.com/v2/adjuncts/?key=166f0b6348fdccde864dc9aecb3d50bb",function(){}).done(function(e){var t=e.currentPage,a=e.numberOfPages;console.log("Number of Adjunct Pages: ",a),i=i.concat(e.data),a>t&&y(t+1,a,l,p,i,"name","adjuncts")})),u?m(f,"styles"):(console.log("loop 1"),$.get("https://cors-anywhere.herokuapp.com/http://api.brewerydb.com/v2/styles/?key=166f0b6348fdccde864dc9aecb3d50bb",function(){}).done(function(e){i=i.concat(e.data),y(1,1,u,f,b,"ibuMin","styles")}));var h=function(e,t,a,o){$(o).append('<span class="builder-span" data-id="'+e+'">'+t+"</span></br>")};$("a").click(function(e){if(console.log(e.target),$(this).attr("id")){console.log("if statement");var t=$(this).closest("div").find("option:selected").attr("data-id"),a=$(this).closest("div").find("option:selected").attr("data-name");"name-submit"===$(this).attr("id")||("brewtype-submit"===$(this).attr("id")?h(t,a,"Type","#builder-type"):"styles-submit"===$(this).attr("id")?h(t,a,"Style","#builder-style"):"fermentables-submit"===$(this).attr("id")?h(t,a,"Fermentables","#builder-fermentables"):"hops-submit"===$(this).attr("id")?h(t,a,"Hops","#builder-hops"):"yeasts-submit"===$(this).attr("id")?h(t,a,"Yeast","#builder-yeasts"):"adjuncts-submit"===$(this).attr("id")&&h(t,a,"Adjuncts","#builder-adjuncts"))}}),$("#name-box").on("keyup keydown keypress",function(e){var t=$("#name-box").val();console.log(t),$("#name-display").text(t)}),$("#description-box").on("keyup keydown keypress",function(e){var t=$("#description-box").val();console.log(t),$("#directions-display").text(t)}),$("#notes-box").on("keyup keydown keypress",function(e){var t=$("#notes-box").val();console.log(t),$("#notes-display").text(t)}),$("#new-recipe-btn").on("click",function(){$("#recipe-frontpage").fadeOut("slow",function(){$("#new-recipe").fadeIn(),$("#recipe-builder").css("opacity","1")})})});